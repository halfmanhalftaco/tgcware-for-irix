--- git-1.6.3.1/git-compat-util.h.mapfailed	2009-06-05 09:14:16.000000000 +0200
+++ git-1.6.3.1/git-compat-util.h	2009-06-05 09:14:40.230000000 +0200
@@ -194,6 +194,10 @@
 
 #else /* NO_MMAP */
 
+#ifndef MAP_FAILED
+#define MAP_FAILED ((void*)-1)
+#endif
+
 /* This value must be multiple of (pagesize * 2) */
 #define DEFAULT_PACKED_GIT_WINDOW_SIZE \
 	(sizeof(void*) >= 8 \
